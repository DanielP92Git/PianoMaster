---
phase: 12-validation-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/skillTrail.js
  - src/data/PEDAGOGY.md
autonomous: true

must_haves:
  truths:
    - "LEGACY_NODES array no longer exists in codebase"
    - "No code references LEGACY_NODES or nodeGenerator"
    - "Build passes with 93 validated nodes"
  artifacts:
    - path: "src/data/skillTrail.js"
      provides: "Clean trail definitions without legacy code"
      contains: "export const SKILL_NODES"
      not_contains: "LEGACY_NODES"
  key_links:
    - from: "src/data/skillTrail.js"
      to: "src/data/expandedNodes.js"
      via: "import expandedNodes"
      pattern: "import expandedNodes from './expandedNodes.js'"
---

<objective>
Delete all legacy trail code from the codebase

Purpose: Complete the v1.3 trail redesign by removing the deprecated LEGACY_NODES array (~594 lines) and any dead code references. The 93-node redesigned system is verified and active.

Output: Clean skillTrail.js with no legacy code, passing build validation.
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-validation-cleanup/12-CONTEXT.md
@.planning/phases/11-integration-cutover/11-01-SUMMARY.md
@src/data/skillTrail.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete LEGACY_NODES from skillTrail.js</name>
  <files>src/data/skillTrail.js</files>
  <action>
Remove the entire LEGACY_NODES array and its JSDoc comment from skillTrail.js. This is approximately lines 250-855 (the @deprecated const LEGACY_NODES declaration).

Steps:
1. Remove the @deprecated JSDoc comment block (lines 253-260)
2. Remove the entire LEGACY_NODES = [...] array declaration (lines 261-855)
3. Keep all other code intact (UNITS, SKILL_NODES export, utility functions)

The file should go from ~965 lines to ~370 lines after deletion.

Do NOT remove:
- Import statements at the top
- UNITS object
- Import of expandedNodes
- SKILL_NODES export (which uses expandedNodes)
- All utility functions (getNodesByCategory, getNodeById, etc.)
  </action>
  <verify>
1. Run: npm run lint -- src/data/skillTrail.js (no errors)
2. Run: npm run build (passes with trail validation showing 93 nodes)
3. Grep: grep -r "LEGACY_NODES" src/ should only return PEDAGOGY.md (documentation)
  </verify>
  <done>
LEGACY_NODES array deleted from skillTrail.js. File reduced from ~965 lines to ~370 lines. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Audit and fix dead code references</name>
  <files>src/data/PEDAGOGY.md</files>
  <action>
Audit codebase for any remaining references to legacy trail code and fix them:

1. Search for LEGACY_NODES references:
   grep -r "LEGACY_NODES" src/ --exclude-dir=node_modules

   Expected: Only PEDAGOGY.md should have a reference (documentation context)

2. Update PEDAGOGY.md to remove/update LEGACY_NODES reference:
   - If it references LEGACY_NODES as "deprecated", update to say "deleted in v1.3"
   - Keep any pedagogical context about the old system for historical reference

3. Search for nodeGenerator references:
   grep -r "nodeGenerator" src/ --exclude-dir=node_modules

   Expected: No results (already cleaned in Phase 10)

4. Search for any runtime legacy node ID references:
   grep -rE "(treble_c_d|treble_c_e|bass_c_b|rhythm_intro)" src/ --exclude-dir=node_modules

   Expected: No results (old node IDs should not be hardcoded anywhere)

5. Run ESLint to catch any unused imports/variables:
   npm run lint

If any unexpected references are found, fix them (update imports, remove dead code paths).
  </action>
  <verify>
1. grep -r "LEGACY_NODES" src/ returns only PEDAGOGY.md with updated text
2. grep -r "nodeGenerator" src/ returns no results
3. npm run lint passes with no errors
4. npm run build passes
  </verify>
  <done>
All legacy code references audited and cleaned. No dead code remains.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify build and commit deletion</name>
  <files></files>
  <action>
Final verification and atomic commit of the legacy code deletion:

1. Run full build validation:
   npm run build

   Expected output should show:
   - Trail Validation with 93 nodes
   - No errors (warnings about XP variance are OK)

2. Run test suite to ensure no regressions:
   npm run test:run

3. Create atomic commit with descriptive message documenting what was deleted:

   git add src/data/skillTrail.js src/data/PEDAGOGY.md
   git commit -m "refactor(trail): remove LEGACY_NODES array

   Delete ~594 lines of deprecated legacy trail node definitions.
   The 93-node redesigned system (v1.3) is now the only trail system.

   - LEGACY_NODES array removed from skillTrail.js
   - PEDAGOGY.md updated to reflect deletion
   - nodeGenerator.js was already removed in Phase 10

   Git history preserves legacy code if ever needed for reference.

   Closes: v1.3 Trail System Redesign - Phase 12 (cleanup)

   Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>"
  </action>
  <verify>
1. git log -1 shows the commit with proper message
2. npm run build passes after commit
3. git diff HEAD~1 --stat shows ~600 lines deleted
  </verify>
  <done>
Legacy code deletion committed. Build passes with 93-node system intact.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. skillTrail.js contains ONLY the redesigned system (no LEGACY_NODES)
2. Build passes: npm run build
3. Tests pass: npm run test:run
4. Lint passes: npm run lint
5. grep -r "LEGACY_NODES" src/ returns only PEDAGOGY.md documentation
6. grep -r "nodeGenerator" src/ returns nothing
</verification>

<success_criteria>
- LEGACY_NODES array completely removed from skillTrail.js
- All legacy code references cleaned up
- Build passes with 93 validated nodes
- Tests pass with no regressions
- Clean commit documenting the deletion
</success_criteria>

<output>
After completion, create `.planning/phases/12-validation-cleanup/12-01-SUMMARY.md`
</output>
