---
phase: 03-game-layout-optimization
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/games/VictoryScreen.jsx
  - src/components/games/shared/UnifiedGameSettings.jsx
autonomous: false

must_haves:
  truths:
    - "VictoryScreen displays correctly in landscape without content being cut off or overflowing"
    - "UnifiedGameSettings modal renders correctly in landscape without content being cut off"
    - "Both modals remain fully functional in portrait mode"
  artifacts:
    - path: "src/components/games/VictoryScreen.jsx"
      provides: "Landscape-optimized victory screen layout"
      contains: "landscape:"
    - path: "src/components/games/shared/UnifiedGameSettings.jsx"
      provides: "Landscape-optimized settings modal layout"
      contains: "landscape:"
  key_links:
    - from: "tailwind.config.js"
      to: "src/components/games/VictoryScreen.jsx"
      via: "landscape: Tailwind modifier"
      pattern: "landscape:"
    - from: "tailwind.config.js"
      to: "src/components/games/shared/UnifiedGameSettings.jsx"
      via: "landscape: Tailwind modifier"
      pattern: "landscape:"
---

<objective>
Optimize VictoryScreen and UnifiedGameSettings modals for landscape orientation, then verify all game layouts on mobile.

Purpose: In landscape, these full-screen modals have limited vertical space. VictoryScreen (currently max-w-md single column) needs a two-column layout to fit scores + buttons without scrolling. UnifiedGameSettings (full-screen overlay with scrollable steps) needs wider layout with side-by-side settings groups.

Output: Both modals render correctly in both orientations. Human verification confirms all layouts work on mobile device.
</objective>

<execution_context>
@C:/Users/pagis/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/pagis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-game-layout-optimization/03-RESEARCH.md
@.planning/phases/03-game-layout-optimization/03-01-SUMMARY.md
@src/components/games/VictoryScreen.jsx
@src/components/games/shared/UnifiedGameSettings.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Optimize VictoryScreen for landscape orientation</name>
  <files>src/components/games/VictoryScreen.jsx</files>
  <action>
The VictoryScreen outer container is `fixed inset-0 z-[9999] flex justify-center overflow-y-auto p-2 sm:p-4` (line 681). Inside is a `max-w-md flex-col` content area (line 706).

**Changes to the outer wrapper (line 681):**
- Add `landscape:items-center` so it vertically centers in landscape (enough horizontal space)
- Add `landscape:p-3` for moderate padding

**Changes to the content container (line 706):**
- Current: `flex w-full max-w-md flex-col items-center my-auto`
- Landscape: widen to two columns:
  - Add `landscape:max-w-3xl landscape:flex-row landscape:flex-wrap landscape:items-start landscape:gap-4`

**Changes to the avatar section (line 708-726):**
- The avatar already uses clamp with vh units so it will naturally shrink in landscape. No changes needed.

**Changes to the content area (line 742):**
- Current: `w-full space-y-1.5 px-2 pt-4 text-center sm:space-y-2 sm:px-4 sm:pt-2`
- Split into two columns in landscape. Wrap the score/stars/XP section and the buttons section in separate divs:
  - Left column (scores, stars, XP): `landscape:w-1/2`
  - Right column (feedback text, action buttons): `landscape:w-1/2`
- If wrapping in divs is complex due to conditional rendering, an alternative approach: add `landscape:grid landscape:grid-cols-2 landscape:gap-4 landscape:text-left` to the content area. The score display, stars, and XP card go in the left implicit column; the buttons go in the right column. Use `landscape:col-span-2` on elements that should span full width (like the title).

**Specific layout in landscape:**
- Title (line 744): `landscape:col-span-2 landscape:text-center` -- spans both columns, centered
- Score display (line 770): stays in left column naturally
- Star rating (line 776): stays in left column
- XP card (line 799): stays in left column
- Points card (line 893): goes to right column start
- Action buttons (line 918): `landscape:col-span-2` -- spans both columns at bottom

**Reduce vertical spacing in landscape:**
- Add `landscape:space-y-1 landscape:py-1` where vertical spacing is generous
- Buttons: reduce `py-3` to `landscape:py-2` on main action buttons

**Critical: Do NOT change any logic, callbacks, state, or conditional rendering. Only add landscape: CSS classes.**
  </action>
  <verify>Run `npm run build`. Then `npm run dev` and test VictoryScreen in both orientations using DevTools responsive mode. In landscape: content should be visible without excessive scrolling, wider layout. In portrait: layout should be identical to current.</verify>
  <done>VictoryScreen renders in a wider, more compact layout in landscape. All content visible without scrolling on typical mobile landscape viewport. Portrait layout unchanged.</done>
</task>

<task type="auto">
  <name>Task 2: Optimize UnifiedGameSettings for landscape orientation</name>
  <files>src/components/games/shared/UnifiedGameSettings.jsx</files>
  <action>
UnifiedGameSettings renders either as a full page (pre-game) or as a modal overlay (in-game settings change). Both modes need landscape optimization.

**Find the main content wrapper** in the component's return JSX. The modal mode wrapper uses `fixed inset-0 z-[9999]`. The pre-game mode renders directly.

**For modal mode:**
- The overlay container: add `landscape:flex landscape:items-center landscape:justify-center`
- The inner content panel: add `landscape:max-w-4xl landscape:max-h-[90vh] landscape:overflow-y-auto`

**For the settings steps content (both modes):**
- The step content area where clef selection, note selection, etc. render:
  - Add `landscape:grid landscape:grid-cols-2 landscape:gap-4` to the steps container so settings render side-by-side instead of stacked
  - Each step section: `landscape:col-span-1`
  - The start/action button row: `landscape:col-span-2` to span full width at bottom

**For the note selection grid:**
- Note buttons are likely in a flex-wrap or grid. In landscape, allow more columns:
  - Add `landscape:grid-cols-6` or similar to spread notes horizontally

**Compact vertical spacing in landscape:**
- Reduce padding: add `landscape:py-2 landscape:px-4` on sections with generous vertical space
- Reduce heading sizes: add `landscape:text-lg` where headings are `text-2xl`

**For the pre-game mode (full page, not modal):**
- The outer container: add `landscape:flex landscape:items-center landscape:justify-center landscape:min-h-screen`
- Content: add `landscape:max-w-4xl landscape:w-full`

**Critical: Only add landscape: CSS classes. Do NOT modify any step configuration, settings logic, event handlers, or conditional rendering.**
  </action>
  <verify>Run `npm run build`. Then `npm run dev`, navigate to any game, and verify the settings screen in both orientations. In landscape: settings should use wider layout with reduced vertical scrolling. In portrait: layout should be identical to current.</verify>
  <done>UnifiedGameSettings uses wider two-column layout in landscape. Settings visible with minimal scrolling. Portrait layout unchanged. Build passes.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify all game layouts on mobile device</name>
  <files>none</files>
  <action>
Human verification checkpoint. Present the following verification steps to the user and wait for approval.
  </action>
  <verify>
    1. Open the app on a mobile device (or browser DevTools mobile emulation)
    2. Navigate to Notes Recognition game:
       - Settings screen: rotate to landscape, verify settings render correctly
       - Start game: rotate to landscape, verify note display + answer buttons are side-by-side
       - Complete game: verify VictoryScreen renders correctly in landscape
       - Rotate back to portrait: verify everything still works
    3. Navigate to Sight Reading game:
       - Start game: rotate to landscape, verify VexFlow notation fills wider space
       - Verify notation re-renders smoothly (no flicker, no delay > ~200ms)
       - Rotate back to portrait: verify scroll position preserved, game state intact
    4. Navigate to Metronome Trainer:
       - Start game: rotate to landscape, verify metronome + tap area side-by-side
    5. Navigate to Memory Game:
       - Start game: rotate to landscape, verify card grid uses more columns
    6. In any game in portrait mode: verify game is fully playable (WCAG 1.3.4)
  </verify>
  <done>User confirms all game layouts render correctly in both landscape and portrait orientations on mobile. All games remain playable in both orientations.</done>
</task>

</tasks>

<verification>
- `npm run build` passes with zero new errors
- VictoryScreen.jsx contains `landscape:` class modifiers
- UnifiedGameSettings.jsx contains `landscape:` class modifiers
- Human verified: all layouts correct on mobile in both orientations
- No game logic modified in any file
</verification>

<success_criteria>
- VictoryScreen displays in wider two-column layout in landscape
- UnifiedGameSettings displays in wider layout with less scrolling in landscape
- Both modals remain fully functional in portrait mode
- Human verification passes for all 4 games in both orientations
</success_criteria>

<output>
After completion, create `.planning/phases/03-game-layout-optimization/03-03-SUMMARY.md`
</output>
