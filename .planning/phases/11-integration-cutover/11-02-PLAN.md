---
phase: 11-integration-cutover
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - .planning/STATE.md
autonomous: false

must_haves:
  truths:
    - "Build passes with 87 validated nodes"
    - "Trail map renders all three paths (treble, bass, rhythm)"
    - "A node can be started from each category"
    - "Victory screen shows correct XP award"
  artifacts:
    - path: ".planning/STATE.md"
      provides: "Updated project state"
      contains: "Phase 11"
  key_links:
    - from: "npm run build"
      to: "scripts/validateTrail.mjs"
      via: "prebuild hook"
      pattern: "prebuild.*validateTrail"
---

<objective>
Verify the cutover works correctly and update project state.

Purpose: This plan validates that the cutover changes from Plan 01 produce a working trail system. It runs the build (which triggers validation), then pauses for human smoke testing to verify the UI works correctly.

Output: Verified working system ready for deployment, updated STATE.md.
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-integration-cutover/11-CONTEXT.md
@.planning/phases/11-integration-cutover/11-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run build and validate trail</name>
  <files></files>
  <action>
Execute the validation and build pipeline:

1. Run trail validation directly:
   ```bash
   npm run verify:trail
   ```
   Expected output:
   - "Validating 87 trail nodes..."
   - "Prerequisite chains: OK"
   - "Node types: OK"
   - "Unique IDs: OK (87 nodes)"
   - WARNING about XP variance is acceptable (42% variance documented in RESEARCH.md)

2. Run full build (triggers prebuild validation):
   ```bash
   npm run build
   ```
   Build MUST succeed. If validation fails, build fails.

3. Capture validation output showing node counts:
   - Treble: 19 nodes (Units 1-3)
   - Bass: 25 nodes (Units 1-3)
   - Rhythm: 42 nodes (Units 1-6)
   - Total: ~86-87 nodes

WHY run both:
- verify:trail gives detailed output for debugging
- build proves the full pipeline works including prebuild hook
  </action>
  <verify>
`npm run build` exits with code 0
Build output does NOT contain "Validation FAILED"
dist/ folder is created/updated
  </verify>
  <done>Build succeeds with 87 nodes validated, dist folder generated</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Trail system cutover complete. SKILL_NODES now contains only the 87 redesigned nodes from expandedNodes.js. Migration file ready for progress reset.
  </what-built>
  <how-to-verify>
Start the dev server and test the trail:

1. Run `npm run dev` (if not already running)

2. Open http://localhost:5174/trail in browser

3. Verify Trail Map loads:
   - [ ] Page renders without errors
   - [ ] Three paths visible (Treble, Bass, Rhythm)
   - [ ] Nodes have correct states (first node of each path should be unlocked)

4. Test one node from each category:
   - [ ] Click a treble clef node (e.g., first Discovery node)
   - [ ] Modal opens with node details
   - [ ] Click "Start Practice"
   - [ ] Game loads without errors
   - [ ] (Optional) Complete exercise, verify VictoryScreen shows XP

5. Check console for errors:
   - [ ] No JavaScript errors related to missing nodes
   - [ ] No "node not found" warnings

If any issue found, describe it so we can fix before deployment.
  </how-to-verify>
  <resume-signal>Type "approved" if smoke test passes, or describe any issues found</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Update project state</name>
  <files>.planning/STATE.md</files>
  <action>
Update STATE.md to reflect Phase 11 completion:

1. Update "Current Position" section:
   - Phase: 11 of 12 (Integration & Cutover) - COMPLETE
   - Plan: 2 of 2 in current phase (COMPLETE - Verification)
   - Status: Phase complete, ready for Phase 12 (Validation & Cleanup)
   - Last activity: 2026-02-04 - Completed 11-02-PLAN.md (Verification)

2. Update Progress bar:
   - v1.3 progress: ~95% (11/12 phases)

3. Add Phase 11 decisions table:
   | ID | Decision | Rationale |
   |----|----------|-----------|
   | 11-01-01 | Silent progress reset | Per CONTEXT.md - no in-app notification |
   | 11-01-02 | XP totals preserved | Maintains user motivation despite trail reset |
   | 11-02-01 | LEGACY_NODES kept in file | Phase 12 handles deletion, keeps cutover atomic |

4. Update Session Continuity:
   - Last session: 2026-02-04
   - Stopped at: Completed Phase 11 (Integration & Cutover)
   - Resume file: None - ready for Phase 12 (Validation & Cleanup)

5. Update "Last updated" timestamp at bottom

Note: This task runs AFTER smoke test approval.
  </action>
  <verify>
`grep "Phase 11" .planning/STATE.md` returns matches showing phase 11 progress
`grep "11-01-01" .planning/STATE.md` returns match showing decision recorded
  </verify>
  <done>STATE.md reflects Phase 11 completion, ready for Phase 12</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Build passes with 87 nodes validated
2. Human confirmed trail map works correctly
3. STATE.md updated with Phase 11 completion
4. System ready for deployment
</verification>

<success_criteria>
- npm run build succeeds (validates 87 nodes)
- Trail map renders all three paths correctly
- At least one node from each category can be started
- No JavaScript errors in console
- STATE.md updated to reflect completion
- Ready to commit and deploy
</success_criteria>

<output>
After completion, create `.planning/phases/11-integration-cutover/11-02-SUMMARY.md`
</output>
