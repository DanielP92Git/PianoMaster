---
phase: 06-trail-stabilization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/constants.js
  - src/data/nodeTypes.js
  - src/data/trailSections.js
  - src/data/units/trebleUnit1Redesigned.js
  - src/data/units/trebleUnit2Redesigned.js
  - src/data/units/trebleUnit3Redesigned.js
  - src/data/skillTrail.js
  - src/data/expandedNodes.js
  - src/utils/nodeGenerator.js
  - src/utils/progressMigration.js
  - src/components/games/notes-master-games/MemoryGame.jsx
  - src/components/trail/TrailMap.jsx
  - src/components/trail/TrailNodeModal.jsx
  - supabase/migrations/20260129000002_add_unit_tracking.sql
  - supabase/migrations/20260129000003_add_delete_policies.sql
autonomous: true

must_haves:
  truths:
    - "All trail redesign code is version controlled"
    - "Git history shows logical commit separation (foundation vs integration)"
    - "No uncommitted trail-related changes remain"
  artifacts:
    - path: "src/data/constants.js"
      provides: "Shared constants for trail system"
      status: "committed"
    - path: "src/data/nodeTypes.js"
      provides: "Node type definitions"
      status: "committed"
    - path: "src/data/units/trebleUnit1Redesigned.js"
      provides: "Unit 1 node definitions"
      status: "committed"
  key_links:
    - from: "src/data/skillTrail.js"
      to: "src/data/units/*.js"
      via: "imports redesigned units"
      pattern: "import.*trebleUnit.*Redesigned"
---

<objective>
Commit all existing trail redesign work with logical commit structure.

Purpose: Preserve all trail redesign work in version control before testing. This ensures work is not lost and creates clean git history for review.
Output: 2-3 git commits preserving all trail redesign files with proper commit messages.
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-trail-stabilization/06-RESEARCH.md

# Key source files (already exist, uncommitted)
@src/data/constants.js
@src/data/nodeTypes.js
@src/data/skillTrail.js
@src/components/games/notes-master-games/MemoryGame.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Commit trail foundation files</name>
  <files>
    src/data/constants.js
    src/data/nodeTypes.js
    src/data/trailSections.js
    src/data/units/trebleUnit1Redesigned.js
    src/data/units/trebleUnit2Redesigned.js
    src/data/units/trebleUnit3Redesigned.js
    src/utils/nodeGenerator.js
  </files>
  <action>
Stage and commit the foundation files that were created as part of the trail redesign Phase 1.

1. Stage foundation files:
   ```bash
   git add src/data/constants.js src/data/nodeTypes.js src/data/trailSections.js
   git add src/data/units/
   git add src/utils/nodeGenerator.js
   ```

2. Create commit with descriptive message using Conventional Commits format:
   ```bash
   git commit -m "$(cat <<'EOF'
   feat(trail): add redesigned treble clef Units 1-3 foundation

   - Add shared constants file (NODE_CATEGORIES, EXERCISE_TYPES)
   - Define 8 node types (Discovery, Practice, Mix-Up, Speed Round, etc.)
   - Add section-based organization system
   - Create Units 1-3 with 26 nodes total (vs 18 in old system)
   - Implement one-note-at-a-time pedagogy
   - Remove eighth notes from Units 1-3 (pedagogically correct)

   Units 1-3 introduce C4-C5 progressively with 8 distinct node types
   for psychological variety and engagement.

   Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
   EOF
   )"
   ```

Foundation files define node types, constants, and unit configurations without circular dependencies.
  </action>
  <verify>
Run `git log -1 --oneline` shows the foundation commit.
Run `git status` shows remaining uncommitted files (integration files + migrations).
  </verify>
  <done>Foundation commit created with 7+ files covering constants, nodeTypes, trailSections, units/, and nodeGenerator.</done>
</task>

<task type="auto">
  <name>Task 2: Commit trail integration files</name>
  <files>
    src/data/skillTrail.js
    src/data/expandedNodes.js
    src/utils/progressMigration.js
    src/components/games/notes-master-games/MemoryGame.jsx
    src/components/trail/TrailMap.jsx
    src/components/trail/TrailNodeModal.jsx
  </files>
  <action>
Stage and commit the integration files that wire up the trail redesign with existing components.

1. Stage integration files:
   ```bash
   git add src/data/skillTrail.js src/data/expandedNodes.js
   git add src/utils/progressMigration.js
   git add src/components/games/notes-master-games/MemoryGame.jsx
   git add src/components/trail/TrailMap.jsx src/components/trail/TrailNodeModal.jsx
   ```

2. Create commit:
   ```bash
   git commit -m "$(cat <<'EOF'
   feat(trail): integrate memory game with trail navigation

   - Add trail auto-start to MemoryGame component
   - Update TrailMap and TrailNodeModal for memory game nodes
   - Wire navigation between note recognition, sight reading, memory game
   - Update expandedNodes to use redesigned units
   - Update progressMigration for new node structure

   Memory game now works seamlessly with trail nodes treble_1_4,
   treble_2_5, and treble_3_8 with auto-configuration.

   Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
   EOF
   )"
   ```

Integration files connect the new node definitions to UI components and game logic.
  </action>
  <verify>
Run `git log -2 --oneline` shows both foundation and integration commits.
Run `git status` shows only migrations remaining as uncommitted.
  </verify>
  <done>Integration commit created with 6 files covering skillTrail, expandedNodes, MemoryGame, TrailMap, TrailNodeModal, progressMigration.</done>
</task>

<task type="auto">
  <name>Task 3: Commit database migrations</name>
  <files>
    supabase/migrations/20260129000002_add_unit_tracking.sql
    supabase/migrations/20260129000003_add_delete_policies.sql
  </files>
  <action>
Stage and commit the database migrations for the trail redesign.

1. Stage migration files:
   ```bash
   git add supabase/migrations/20260129000002_add_unit_tracking.sql
   git add supabase/migrations/20260129000003_add_delete_policies.sql
   ```

2. Create commit:
   ```bash
   git commit -m "$(cat <<'EOF'
   feat(db): add unit tracking and delete policies for trail system

   - Add unit_tracking migration for progress persistence
   - Add delete_policies for RLS security on trail tables

   Migrations support the redesigned trail system with proper
   data persistence and security policies.

   Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
   EOF
   )"
   ```
  </action>
  <verify>
Run `git log -3 --oneline` shows all three commits (foundation, integration, migrations).
Run `git status` shows only untracked temp files remain (IMPLEMENTATION_STATUS.md, TEST_PLAN.md, etc.).
  </verify>
  <done>Migrations committed. All trail code now version controlled. Only temp documentation files remain untracked.</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Run `git log --oneline -5` - should show 3 new commits
2. Run `git status` - should show only temp files as untracked (IMPLEMENTATION_STATUS.md, TEST_PLAN.md, etc.)
3. Run `npm run dev` - app should start without errors
4. Navigate to /trail - trail map should load without console errors
</verification>

<success_criteria>
- 3 commits created with logical separation (foundation, integration, migrations)
- All trail-related source files are committed
- App starts without errors after commits
- Git history follows Conventional Commits format
- Requirements covered: TRAIL-01, TRAIL-02
</success_criteria>

<output>
After completion, create `.planning/phases/06-trail-stabilization/06-01-SUMMARY.md`
</output>
